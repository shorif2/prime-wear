---
import {
  getAllCollections,
  getCollectionById,
} from "../../lib/apiRequest/dataFetching";
import ProductCard from "./ProductCard.astro";

// Try to get products from API
const collection = await getCollectionById("awjozLK92GIUPLIwVvBU-");
let products = collection?.products;

// Fallback sample products if API doesn't return data
if (!products || products.length === 0) {
  products = [
    {
      id: "sample-1",
      name: "Premium Cotton T-Shirt",
      price: 29.99,
      discountedPrice: 24.99,
      discountPercentage: 16.67,
      slug: "premium-cotton-tshirt",
      imageUrl: "/images/products/product1.jpg",
    },
    {
      id: "sample-2",
      name: "Denim Jacket",
      price: 89.99,
      discountedPrice: 79.99,
      discountPercentage: 11.11,
      slug: "denim-jacket",
      imageUrl: "/images/products/product2.jpg",
    },
    {
      id: "sample-3",
      name: "Casual Sneakers",
      price: 59.99,
      discountedPrice: 49.99,
      discountPercentage: 16.67,
      slug: "casual-sneakers",
      imageUrl: "/images/products/product3.jpg",
    },
    {
      id: "sample-4",
      name: "Wool Sweater",
      price: 69.99,
      discountedPrice: 59.99,
      discountPercentage: 14.29,
      slug: "wool-sweater",
      imageUrl: "/images/products/product4.jpg",
    },
  ];
}
---

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-16">
  <h2 class="text-2xl font-medium text-gray-800 uppercase mb-6">
    TRENDING PRODUCTS
  </h2>
  <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
    {
      products?.map((product) => (
        <Fragment key={product.id}>
          <ProductCard product={product} />
        </Fragment>
      ))
    }
  </div>
</div>
